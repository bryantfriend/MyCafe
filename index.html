<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MyCafe ‚Äì Find Caf√©s in Bishkek</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css" />
</head>
<body class="text-brown-800" style="background-color: #F3E9DD;">

  <header class="flex flex-wrap justify-between items-center px-6 py-4 bg-yellow-100 shadow-sm">
    <div class="flex items-center gap-2">
      <img src="assets/logo.png" alt="MyCafe Logo" class="w-8 h-8" />
      <span class="text-xl font-bold">MyCafe</span>
    </div>
    <nav class="flex flex-wrap justify-center md:justify-end items-center gap-4 w-full md:w-auto mt-2 md:mt-0">
      <a href="#" class="hover:underline">Explore</a>
      <a href="#" class="hover:underline">Favorites</a>
      <a href="#" class="hover:underline">Games</a>
      <button id="loginBtn" class="bg-yellow-800 text-white px-3 py-1 rounded hover:bg-yellow-900">Log in</button>
    </nav>
  </header>
    
  <section class="flex justify-center items-center w-full my-4">
    <div class="inline-flex items-center justify-center gap-2 px-2 py-2 rounded-full shadow-sm" id="flagCarousel" style="background-color: #fce9d4;">
        <button id="leftArrow" class="text-xl font-bold text-gray-700 px-1">&#9664;</button>
        <div class="flex items-center justify-center gap-2" id="flagTrack">
            </div>
        <button id="rightArrow" class="text-xl font-bold text-gray-700 px-1">&#9654;</button>
    </div>
  </section>

  <section class="text-center py-6">
    <h1 class="text-3xl md:text-4xl font-bold">Find the best caf√©s in Bishkek</h1>
  </section>
    
  <section class="flex justify-center gap-4 flex-wrap mb-6 px-4">
    <button class="bg-tan-light px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm">
      <span>üìç</span> Location
    </button>
    <button class="bg-tan-light px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm">
      <span>üçΩÔ∏è</span> Food & Drinks
    </button>
    <div class="relative">
        <select class="bg-tan-light pl-4 pr-8 py-2 rounded-lg flex items-center gap-2 shadow-sm appearance-none cursor-pointer">
            <option disabled selected>Price</option>
            <option value="asc">Cheapest to Expensive</option>
            <option value="desc">Expensive to Cheapest</option>
        </select>
        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
        </div>
    </div>
  </section>

  <main id="cafeGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 px-6 pb-12">
    </main>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
      import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

      // Firebase Config...
      const firebaseConfig = {
        apiKey: "AIzaSyBJVYVWvzVPGwezU0nPkfPQE8wpnEIRZTIU",
        authDomain: "mycafe-39b53.firebaseapp.com",
        projectId: "mycafe-39b53",
        storageBucket: "mycafe-39b53.appspot.com",
        messagingSenderId: "11006381908561",
        appId: "1:11006381908561:web:d3a911adc3259ea4fc2e70"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      const cafeGrid = document.getElementById("cafeGrid");

      const snapshot = await getDocs(collection(db, "cafes"));
      const cafes = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

      // ‚ú® --- START OF FIX --- ‚ú®
      cafes.forEach(cafe => {
        // Create a container div for the image and title.
        const el = document.createElement("div");
        el.className = "text-center";
        
        // The link now wraps ONLY the image. The container div has no background.
        // A hover effect is applied to the image itself.
        el.innerHTML = `
          <a href="cafe.html?id=${cafe.id}" class="inline-block">
            <img src="${cafe.imageUrl}" alt="${cafe.name}" class="coffee-img mx-auto rounded-lg shadow-md transform transition hover:-translate-y-1 hover:shadow-xl" />
          </a>
          <h2 class="font-bold text-lg mt-2">${cafe.name}</h2>
        `;

        cafeGrid.appendChild(el);
      });
      // ‚ú® --- END OF FIX --- ‚ú®
      
      // Language carousel logic...
      let selectedLang = localStorage.getItem("lang") || 'en';
      document.documentElement.lang = selectedLang;

      const coreLanguages = [
        { code: 'ky', label: 'KG', flagCode: 'kg' },
        { code: 'ru', label: 'RU', flagCode: 'ru' },
        { code: 'en', label: 'EN', flagCode: 'us' },
      ];

      let currentLangIndex = coreLanguages.findIndex(l => l.code === selectedLang);
      if (currentLangIndex === -1) currentLangIndex = 2;

      function renderFlagCarousel() {
          const track = document.getElementById('flagTrack');
          track.innerHTML = '';

          for (let offset = -1; offset <= 1; offset++) {
              let index = (currentLangIndex + offset + coreLanguages.length) % coreLanguages.length;
              const lang = coreLanguages[index];
              const wrapper = document.createElement('div');
              wrapper.className = 'flag' + (offset === 0 ? ' selected' : '');
              wrapper.innerHTML = `<img src="https://flagcdn.com/w40/${lang.flagCode}.png" alt="${lang.label}" /><div class="flag-label">${lang.label}</div>`;
              wrapper.dataset.code = lang.code;
              track.appendChild(wrapper);
          }
          selectedLang = coreLanguages[currentLangIndex].code;
          localStorage.setItem('lang', selectedLang);
          document.documentElement.lang = selectedLang;
      }

      document.getElementById('leftArrow').onclick = () => {
        currentLangIndex = (currentLangIndex - 1 + coreLanguages.length) % coreLanguages.length;
        renderFlagCarousel();
      };

      document.getElementById('rightArrow').onclick = () => {
        currentLangIndex = (currentLangIndex + 1) % coreLanguages.length;
        renderFlagCarousel();
      };
      
      renderFlagCarousel();
      
      document.getElementById('loginBtn').addEventListener('click', () => {
        window.location.href = 'login.html';
      });
    </script>
</body>
</html>